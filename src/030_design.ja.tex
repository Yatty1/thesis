\chapter{提案手法、アプローチ}
\label{chap:design}

本章では、本研究の目的を達成するための手法とその設計を示す。

\section{概要}

本論文で提案する手法では、糖尿病患者のインスリン打ち忘れを検知するために以下の2つのイベントが起こった時間を用いり、
これらを活用することで、患者がインスリンを打ち忘れた際に通知をすることを目指す。

\begin{enumerate}
  \item インスリンペンを使用してインスリンが摂取された時間
  \item 患者本人が食事を開始した時間
\end{enumerate}

インスリンペンを使用してインスリンが摂取された時間は、インスリン自体が摂取されたことを図るのに必要になるが、これは２番目の食事を開始した時間と比較して食前にインスリンが摂取されたかどうかを判別するための重要なデータとなる。
食事を開始した時間については今述べたようにインスリンが摂取された時間との比較に使うが、この食事というイベントの時間を利用することで、固定時間式のリマインダーなどよりも即時性が高くなる。
患者は、もし打ち忘れたことを食事中、ないし食事終了直後に気づくことができた場合、通常通りインスリンを打てば良いとされており、\cite{insulin_qa_sakaemachi_nishi} \cite{insulin_qa_akaike}
さらに後になって気付いた場合には、担当医と連絡を取り、指示を仰いだ上で正確な対処を自分で行わなければならない。\cite{insulin_qa_senior}
糖尿病患者にとっての負担を減らすためにも、この即時性は重要な点であるため、今回、この食事というイベント駆動の手法を提案した。

そしてこれら2つの時間データを取得するためには以下の2つのデバイスが必要になる。

\begin{enumerate}
  \item インスリンペンに装着し、インスリンが投与されたことを検知、その時間を取得するデバイス（名前つける）
  \item 食事開始を検知し、その時間を取得するデバイス
\end{enumerate}

今回の実装では、（インスリンペンに装着するデバイス（短い、かつはっきりと何を指しているかわかる名前に置き換える））は時間を取得した後、独自のwebサーバーにその検知時間をアップロードする。
これによりwebサーバーを通じてデータベースにその時間が記録される。
そして2の（食事開始を検知し、その時間を取得するデバイス（短い、かつはっきりと何を指しているかわかる名前に置き換える））は、その時間が取得された際に、データベースに記録された直近のインスリン摂取時間を確認、比較する。
比較した結果、そのインスリン摂取時間が食事開始時間よりも前で、さらにその差が所定の時間以内だった場合はインスリンは正常に摂取されたと判定し、
そうでなかった場合にはインスリン摂取は行われず、患者は打ち忘れていると判定し通知を行う。

図\ref{fig:insulin_design}にその概要とフローを示す。

\begin{figure}
  \caption{インスリン打ち忘れ検知の概要とフロー}
  \label{fig:insulin_design}
  \begin{center}
    % \includegraphics[bb=0 0 1000 530,width=15cm]{assets/}
  \end{center}
\end{figure}


